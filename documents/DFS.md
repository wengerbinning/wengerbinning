DFS（Dynamic Frequency Selection，动态频率调整）技术




DFS是一种允许未经许可的设备使用已分配给雷达系统的5GHz频段而不不影响雷达系统的技术。该技术是实现未授权的设备在正在使用的5GHz的信道上检测雷达的存在，如果检测到雷达的信号高于特定阀值，则跳出该信道并选择一个备用信道。其目标是实现与雷达系统实现5GHz频道共存，并实现在均匀分布在整个频段中，在5GHz频段中有许多的信道可供无限设备使用；同时也要求随机选择信道实现均匀利用整个频段。

通常而言，雷达信号是长度为1～100us的周期性窄带脉冲或者50～100us的啁啾脉冲的形式，在检测到雷达信号时，需要在10s内切换信道。

信道可用性检测时间（CRC，Channnel Aailability Check Time）：在系统选择的信道并进行通信前，检测是否雷达存在雷达信道的时间。

干扰检测阀值（IDT，Interference Detection Threshold）：最小信号强度，假设天线为0dB，是系统可检测到移动到另一个信道的最小信号电平。

信道移动时间（CMT，Channel Move Time）：系统清除信道的时间，从检测到雷达脉冲到信道传输完毕所用的时间。

信道关闭传输时间（CCT，Channel Closing Transmission Time）：在系统转移信道期间的总传输时间。

非占用时间（NOT，Non-Occupancy Time）：在信道检测到雷达之后，该信道可能不被使用的一段时间。30mins

主设备（Master Device）：具有雷达探测能力并可以控制网络中其他设备的设备。

从设备（Slave Device）：为经注设备授权不会在信道上发起通信的设备。


DFS过程：

    主设备选择一个DFS信道，并开始进行CAC周期检测，当未检测到雷达信号（在检测到雷达信号时，将该信道添加到NOL list中并重现选择信道），则开始使用该信道并持续检测可能出现的雷达信号（称为在用监视）。如果检测到雷达信号，则主设备向其他网络内的设备发出停止传输的命令，并将该信道添加到雷达列表中，之后重现选择信道。一旦雷达列表中的某个信道的非法占用期过去，就可以清除该信道。


    在高通技术公司芯片中有专用雷达检测模块负责雷达脉冲和传入的信标/管理或数据帧。如果硬件检测到一个Radar，则产生一个中断，MAC
    层会提供RSSI、Pulse、Timestamp、FFT data到软件。存在一个Radar的消息序列来存储RSSI、pluse width、timestamp供中断处理。同时也存在DFS定时器来读取radar消息队列中的内容通过一个radar过滤表。
    radar PHY 可以传输信号到固件（Offload）。

    从设备的最大发送功率超过200mW必须遵循DFS，在现实中，如果客户端的最大Tx功率超过200mW，驱动程序不会自动检测到它。