# 虚拟文件系统

VFS是内核子系统，为用户空间程序提供文件和文件系统相关的接口；采用通用文件系统接口。


## 通用文件系统模型



## UNIX文件系统

UNIX文件系统存在四种抽象概念：文件、目录、索引结点、挂载点。

* 文件是一个有序的字符串。
* 目录是一个组织文件的文件。
* 索引结点保存文件的元数据：控制访问权限、大小、拥有者、创建时间等信息，存在超级快中。


**struct super_block**
 
各类文件系统必须实现超级块对象，用于存储特定的文件系统信息，通常对应于存放在磁盘特定扇区中的文件系统超级快或文件系统控制块，对于并非基于磁盘
的文件系统，会在使用现场创建的超级块

**struct inode**

索引结点包含了内核在操作文件或目录是需要的全部信息，对与UNIX风格的文件系统来说，这些信息可以从磁盘中直接读入，如果那个件系统没有索引结点，需要
提取这些信息，在内存中创建索引结点，在文件被访问时，在内存中创建结点，代表一个文件


**struct dentry**

目录项是VFS引入的为方便查找操作，在路径中所有的目录对被当作目录项。VFS在执行目录操作时，会创建目录项对象。目录项有三种状态：被使用、未被使用以及
负状态。目录项一般被缓存在目录项缓存中。


**struct file**

file是描述进程已经打开的文件，包含访问模式、当前偏移等信息。该对象由open创建，close销毁。


**struct file_system_type**

file_system_type用来描述各种特定的文件系统类型，例如ext3、ext4等。

**struct vfsmount**

vfsmount用于描述挂载点的信息，

**struct file_struct**

file_struct用于描述进程已打开的文件，

**struct fs_struct**

fs_struct包含文件系统和进程相关的信息，

**struct mmt_namespace**



-----------


每一个文件系统都是由file_system_type结构体来表示，描述文件系统及其性能；
每一个挂载点由一个vfsmount结构体来表示。


------