# 调试器

调试器是用来调试程序的工具，现有的调试器包括gdb、kgdb、xxgdb、mxgdb、ddd、ups等，这里以gdb作为主要调试工具。gdb提供高层的符号调试（根据源码来分析程序）以及
底层的调试（根据可执行程序来分析）。使用调试器可以控制与监控程序，同时提供检查core文件。

核心文件是在程序执行过程中出现严重错误时创建的文件，该文件包含发生错误时该程序和系统的状态信息；核心文件是由计算机内存的转储构成，为节省计算机的磁盘空间，核心文件
可能没有被保存，需要手动使用ulimit开启。

在调试的程序之前，需要确认该程序是包含符号表并在编译过程中使用`-g`参数来生成一些调试所需的额外信息。符号表包含程序中用到的所有变量的名称和它们相关值的列表，如果
没有符号表，将不能现实变量的值与类型；没有使用`-g`参数，gdb将不能用行好来识别源码。


根据未剥离符号表的程序文件以及产生的core文件进行gdb调试。gdb命令会根据命令树来确定命令，例如backtrace，输入ba，bt就可以调用，即使用命令唯一字符子集就可以识别。

```shell
gdb pragram core
```

* 通过`list`来显示源码。

```gdb
// 显示源码。
list
```

* 通过`break`来创建断点，使程序执行到这里暂停运行；可以使用行号、实际内存地址、函数名作为参数。

```gdb
break 16
```

* 通过`run`来使程序运行.

```gdb
```

* 打印程序相关信息info，该命令可以答应变量，寄存器等信息。

```gdb
info local 打印局部变量
```

* 打印表达式的值print，

```gdb
print <var>
```

* 打印变量类型

```gdb
ptype 
```

* 设置变量值

```gdb
set print pretty on
```

* 查看函数的反汇编代码disassemble。

```gdb
disassemble /m <function>
```


通用寄存器：

* CS: 
* SS:
* BS:
* EX:
* FS:
* GS:

* RSI
* RDI
* RBP
* RSP：保存栈顶地址的寄存器。
* RIP: 保存当前执行指令的地址的寄存器。



* 通过`continue`来使程序继续运行。

* 通过`backtrace`显示函数栈，即打印出所有的栈帧。如果打印不出来，使用show directories，然后追加directories变量的值

```gdb
backtrace
```


* 通过`frame`来进入指定栈桢，后可以加栈帧索引，如果没有参数，则显示当前所在栈帧。

```gdb
frame <index>
```

* 通过`up`来返回上层栈桢。

* 通过`down`将进入下层栈桢。

